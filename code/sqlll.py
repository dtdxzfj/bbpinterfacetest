import pymysql
import time


class Py_mysql:
    def __init__(self):
        try:
            self.conn = pymysql.Connect(host='172.17.71.101', user='crm_test_user',
                                        password='EyH5O!8Wq!uJKAs3lP', port=22809, database='crm_test_db')
            self.cur = self.conn.cursor()

        except Exception as e:
            print("链接失败，原因：{}".format(e))

    def querysql(self):
        studata= [316812461,121719161,111743162,721824461,848617571,882273911,351654361,439751411,976479571,214744951,276798247,621821691,918593431,741736251,354483382,392994211,168711111,524471511,291536811,131249711,576773341,971172972,326468791,153265141,342662871,112635341,193918711,125313171,764754241,133836641,129571421,524122271,215231121,889263331,231581841,161589691,558251131,325111411,126294781,294879151,134139457,342221621,113624611,312121511,322611241,423943711,627311161,814126495,241671751,712984481,184452231,318242761,991961371,524334881,268262491,123888761,373358191,393247581,849394661,261417527,338631941,276416311,639474671,638141511,568249931,617617771,887943791,215453161,991975621,694939161,638155351,456417851,413599111,111793311,238565921,767725491,357563841,481811491,196723611,767725491,767725491,231772731]
        classdata =[430167,430168,430169,430166,430167,430168,430170,430166,430167,430168,430170,430166,430167,430168,430166,430167,430168,430166,430168,430168,430167,430167,430168,430168,430167,430168,430169,430166,429282,429282,429282,429284,429282,429286,429282,429289,429282,429289,429282,429282,436358,430174,430177,429294,430174,430178,429294,429294,430174,430178,429297,430173,430174,430173,430175,430173,430175,430174,430176,429290,430174,430177,429290,429302,429302,429302,429302,429298,429302,429298,429302,429298,429305,429300,429305,428108,430689,430686,430670,430275,430548,433873]
        for k,v in enumerate(studata):
            # print(item)
            sql1 = f"SELECT * FROM crm_student_class WHERE stu_num={v} AND class_id={classdata[k]}"
            # sql2 = "SELECT * FROM crm_student_class WHERE stu_num='122997791' AND class_id=429279 "
            self.cur.execute(sql1)
            req = self.cur.fetchall()
            for items in req:
                print(items)
            time.sleep(3)


if __name__ == "__main__":
    pp = Py_mysql()
    pp.querysql()
